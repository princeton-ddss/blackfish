(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[782],{6682:function(e,t,s){Promise.resolve().then(s.bind(s,6916))},6916:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return A}});var l=s(7437),r=s(2265),a=s(8516),n=s(1888),i=s(2664),o=s(1323),c=s(6750),d=s(2963),u=s(7920),m=s(945),x=s(8036),f=s(4),h=s(3689),p=s(6885),g=s(4183),b=s(2807),v=s(7634),j=s(6314),w=s(7847),y=s(3577),N=s(7388),k=s(4630);let S=(0,r.createContext)(null);S.displayName="GroupContext";let _=r.Fragment,C=Object.assign((0,w.yV)(function(e,t){var s;let l=(0,r.useId)(),a=(0,b.Q)(),n=(0,p.B)(),{id:_=a||"headlessui-switch-".concat(l),disabled:C=n||!1,checked:P,defaultChecked:E,onChange:T,name:D,value:L,form:F,autoFocus:O=!1,...R}=e,z=(0,r.useContext)(S),[G,I]=(0,r.useState)(null),M=(0,r.useRef)(null),H=(0,h.T)(M,t,null===z?null:z.setSwitch,I),K=(0,u.L)(E),[Z,A]=(0,d.q)(P,T,null!=K&&K),J=(0,m.G)(),[V,q]=(0,r.useState)(!1),B=(0,x.z)(()=>{q(!0),null==A||A(!Z),J.nextFrame(()=>{q(!1)})}),U=(0,x.z)(e=>{if((0,v.P)(e.currentTarget))return e.preventDefault();e.preventDefault(),B()}),W=(0,x.z)(e=>{e.key===N.R.Space?(e.preventDefault(),B()):e.key===N.R.Enter&&(0,j.g)(e.currentTarget)}),Q=(0,x.z)(e=>e.preventDefault()),X=(0,k.wp)(),Y=(0,y.zH)(),{isFocusVisible:$,focusProps:ee}=(0,i.F)({autoFocus:O}),{isHovered:et,hoverProps:es}=(0,o.X)({isDisabled:C}),{pressed:el,pressProps:er}=(0,c.x)({disabled:C}),ea=(0,r.useMemo)(()=>({checked:Z,disabled:C,hover:et,focus:$,active:el,autofocus:O,changing:V}),[Z,et,$,el,C,V,O]),en=(0,w.dG)({id:_,ref:H,role:"switch",type:(0,f.f)(e,G),tabIndex:-1===e.tabIndex?0:null!=(s=e.tabIndex)?s:0,"aria-checked":Z,"aria-labelledby":X,"aria-describedby":Y,disabled:C||void 0,autoFocus:O,onClick:U,onKeyUp:W,onKeyPress:Q},ee,es,er),ei=(0,r.useCallback)(()=>{if(void 0!==K)return null==A?void 0:A(K)},[A,K]),eo=(0,w.L6)();return r.createElement(r.Fragment,null,null!=D&&r.createElement(g.Mt,{disabled:C,data:{[D]:L||"on"},overrides:{type:"checkbox",checked:Z},form:F,onReset:ei}),eo({ourProps:en,theirProps:R,slot:ea,defaultTag:"button",name:"Switch"}))}),{Group:function(e){var t;let[s,l]=(0,r.useState)(null),[a,n]=(0,k.bE)(),[i,o]=(0,y.fw)(),c=(0,r.useMemo)(()=>({switch:s,setSwitch:l}),[s,l]),d=(0,w.L6)();return r.createElement(o,{name:"Switch.Description",value:i},r.createElement(n,{name:"Switch.Label",value:a,props:{htmlFor:null==(t=c.switch)?void 0:t.id,onClick(e){s&&(e.currentTarget instanceof HTMLLabelElement&&e.preventDefault(),s.click(),s.focus({preventScroll:!0}))}}},r.createElement(S.Provider,{value:c},d({ourProps:{},theirProps:e,slot:{},defaultTag:_,name:"Switch.Group"}))))},Label:k.__,Description:y.dk});function P(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter(Boolean).join(" ")}function E(e){let{name:t,value:s,onChange:r,min:a,max:n}=e;return(0,l.jsxs)("div",{className:"sm:col-span-4",children:[(0,l.jsxs)("div",{className:"flex flex-row justify-start",children:[(0,l.jsx)("label",{htmlFor:"username",className:"block grow text-sm font-medium leading-6 text-gray-900",children:t}),(0,l.jsx)("div",{className:"w-8 text-sm font-normal text-gray-900 leading-6",children:s})]}),(0,l.jsx)("div",{className:"mt-0",children:(0,l.jsx)("div",{className:"flex sm:max-w-md",children:(0,l.jsx)("input",{type:"range",name:t,id:t,min:a,max:n,value:s,onChange:r,className:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6"})})})]})}function T(e){let{checked:t,onChange:s,label:r,description:a}=e;return(0,l.jsxs)(C.Group,{as:"div",className:"flex items-center justify-between mt-3",children:[(0,l.jsxs)("span",{className:"flex flex-grow flex-col",children:[(0,l.jsx)(C.Label,{as:"span",className:"text-sm font-medium leading-6 text-gray-900",passive:!0,children:r}),(0,l.jsx)(C.Description,{as:"span",className:"text-sm font-light",children:a})]}),(0,l.jsx)(C,{checked:t,onChange:s,className:P(t?"bg-blue-500":"bg-gray-200","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"),children:(0,l.jsx)("span",{"aria-hidden":"true",className:P(t?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out")})})]})}function D(e){let{parameters:t,setParameters:s}=e;return(0,l.jsx)("div",{className:"bg-white sm:rounded-md mt-2 grow",children:(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsxs)("form",{children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-x-6 gap-y-2 sm:grid-cols-4",children:[(0,l.jsx)(E,{name:"Maximum New Tokens",value:t.max_new_tokens,min:1,max:200,onChange:e=>{s({...t,max_new_tokens:Number(e.target.value)})}}),(0,l.jsx)(E,{name:"Temperature",value:t.temperature,min:0,max:100,onChange:e=>{s({...t,temperature:e.target.value})}}),(0,l.jsx)(E,{name:"Top P",value:t.top_p,min:0,max:100,onChange:e=>{s({...t,top_p:e.target.value})}})]}),(0,l.jsx)(T,{checked:t.details,onChange:()=>{s({...t,details:!t.details})},label:"Details",description:"Return detailed model output"}),(0,l.jsx)(T,{checked:t.return_full_text,onChange:()=>{s({...t,return_full_text:!t.return_full_text})},label:"Full Text",description:"Return full text with response"})]})})})}var L=s(2819);function F(e){let{checked:t,onChange:s,disabled:r,label:a,help:n}=e;return(0,l.jsxs)("div",{className:"relative flex gap-x-3",children:[(0,l.jsx)("div",{className:"flex h-6 items-center",children:(0,l.jsx)("input",{id:"gpu-checkbox",name:"gpu-checkbox",type:"checkbox",disabled:r,checked:t,onChange:s,className:"h-4 w-4 rounded border-gray-300 text-blue-500 focus:ring-blue-500 disabled:bg-gray-100"})}),(0,l.jsxs)("div",{className:"text-sm leading-6",children:[(0,l.jsx)("label",{htmlFor:"offers",className:"font-medium text-gray-900",children:a}),(0,l.jsx)("p",{className:"text-gray-500",children:n})]})]})}function O(e){let{containerOptions:t,setContainerOptions:s,disabled:r}=e;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("fieldset",{children:[(0,l.jsx)("legend",{className:"text-sm font-semibold leading-6 text-gray-900",children:"Deployment"}),(0,l.jsx)("p",{className:"mt-1 mb-2 text-sm leading-6 text-gray-600",children:"Customize the service deployment."}),(0,l.jsx)(F,{checked:t.disableCustomKernels,onChange:()=>s(e=>({...e,disable_custom_kernels:!e.disable_custom_kernels})),label:"Disable Custom Kernels",help:"Disables custom CUDA kernels that may not work on all devices.",disabled:r})]})})}function R(e){let{selectedService:t,setSelectedService:s,profile:a}=e,n=r.useMemo(()=>({revision:null,disable_custom_kernels:!1}),[]),[i,o]=r.useState({...n}),[c,d]=r.useState(!1),[u,m]=r.useState(!1),[x,f]=r.useState(!1),[h,p]=r.useState(null),[g,b]=r.useState({});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"pb-4 mb-4 border-b",children:(0,l.jsx)("button",{type:"button",className:"mt-1 w-full flex flex-row justify-center gap-x-2 rounded-md bg-tranparent px-3.5 py-1.5 text-sm font-regular shadow-sm hover:bg-blue-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 border bg-blue-500 text-white",onClick:()=>{d(!0)},children:"Open Launcher"})}),(0,l.jsx)(L.Z,{open:c,setOpen:d,defaultContainerOptions:n,containerOptions:i,setContainerOptions:o,launchSuccess:u,setLaunchSuccess:m,isLaunching:x,setIsLaunching:f,launchError:h,setLaunchError:p,validationErrors:g,setValidationErrors:b,selectedService:t,setSelectedService:s,profile:a,image:"text-generation",children:(0,l.jsx)(O,{containerOptions:i,setContainerOptions:o,disabled:x||u})})]})}function z(e){let{selectedService:t,setSelectedService:s,parameters:r,setParameters:i,profile:o,setProfile:c}=e;return(0,l.jsxs)("div",{className:"flex flex-col w-96 p-8 pr-12 bg-white overflow-auto",children:[(0,l.jsx)(a.ZP,{selectedProfile:o,setSelectedProfile:c}),(0,l.jsx)(n.Z,{selectedService:t,setSelectedService:s,profile:o,image:"text-generation",children:(0,l.jsx)(R,{selectedService:t,setSelectedService:s,profile:o})}),(0,l.jsx)(D,{parameters:r,setParameters:i})]})}function G(e){let{prompt:t,setPrompt:s,response:r,isLoading:a}=e;return(0,l.jsx)("div",{className:"grow w-5/6 sm:w-full max-w-6xl border border-gray-300 rounded-md mb-1",children:(0,l.jsx)("div",{className:"h-full px-4 sm:px-6 lg:px-8",children:(0,l.jsx)("div",{className:"h-full py-6 flow-root",children:(0,l.jsx)("div",{className:"h-full overflow-x-auto sm:-mx-6 lg:-mx-8",children:(0,l.jsx)("div",{className:"h-full inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8",children:(0,l.jsxs)("form",{action:"#",className:"flex flex-col h-full",children:[(0,l.jsx)("textarea",{name:"prompt",id:"prompt",className:"overflow-y-visible h-fit block w-full resize-none border-0 border-b border-transparent ring-0 p-0 pb-2 text-gray-900 placeholder:text-gray-300 focus:border-0 focus:ring-0 sm:leading-6 font-light",placeholder:"Write me a haiku about orcas.",value:t,onChange:e=>s(e.target.value)}),(0,l.jsx)("textarea",{name:"response",id:"response",className:"grow block w-full resize-none border-0 border-b border-transparent p-0 pb-2 font-light placeholder:text-gray-400 focus:border-0 focus:ring-0 sm:leading-6 bg-gradient-to-r from-blue-600 via-blue-950 to-blue-400 text-transparent bg-clip-text",value:r,onChange:()=>null,disabled:!0})]})})})})})})}var I=s(7442);async function*M(e,t,s){var l;let r=JSON.stringify({inputs:t,parameters:{...s,top_p:s.top_p/100,temperature:s.temperature/100}});console.debug("Starting text generation stream...");let a=await fetch("http://localhost:".concat(e.port,"/generate_stream"),{method:"POST",headers:{"Content-Type":"application/json"},body:r});if(!a.ok){let e=Error("Stream request failed.");throw e.status=a.status,e}let n=null===(l=a.body)||void 0===l?void 0:l.getReader(),i=new TextDecoder;for(;;){let{value:e,done:t}=await n.read();if(t){console.debug("Stream done.");break}let s=i.decode(e,{stream:!0}).split("\n\n");console.debug("Received chunks:",s);let l=s.filter(e=>""!==e).map(e=>JSON.parse(e.replace("data: ","")));yield l}}function H(e){let{selectedService:t,params:s,prompt:r,setResponse:a,setIsLoading:n}=e,i=async e=>{e.preventDefault();let l=""===r?"Write me a haiku about orcas.":r;n(!0),a("");let i=M(t,l,s),o=await i.next();n(!1);let c=o.value.map(e=>e.token.text).join("").trimStart();for await(let e of(a(e=>e+c),i)){let t=e.map(e=>e.token.text).join("");a(e=>e+t)}};return(0,l.jsx)("div",{className:"flex flex-row w-1/2 max-w-2xl mb-8",children:(0,l.jsx)("div",{className:"grow w-full",children:(0,l.jsx)("form",{onSubmit:i,className:"mt-2 flex rounded-md",children:(0,l.jsxs)("button",{type:"submit",disabled:!t||"HEALTHY"!==t.status,className:"relative disabled:text-gray-400 -ml-px inline-flex items-center gap-x-1.5 rounded-md px-3 py-2 text-sm font-medium text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:[(0,l.jsx)(I.Z,{className:"-ml-0.5 h-5 w-5","aria-hidden":"true"}),t?"Submit to ".concat(t.name):"Submit"]})})})})}function K(e){let{selectedService:t,parameters:s}=e,[a,n]=r.useState(""),[i,o]=r.useState(""),[c,d]=r.useState(!1);return(0,l.jsxs)("div",{className:"flex flex-col grow p-4 pt-6 pl-8 bg-white",children:[(0,l.jsx)(G,{prompt:a,setPrompt:n,response:i,setResponse:o,isLoading:c}),(0,l.jsx)(H,{selectedService:t,params:s,prompt:a,setResponse:o,setIsLoading:d})]})}var Z=s(408);function A(){let{profile:e,setProfile:t}=(0,r.useContext)(a.JT),{services:s,error:n,isLoading:i}=(0,Z.Su)(e,"text-generation"),[o,c]=r.useState(null),[d,u]=(0,r.useState)({max_new_tokens:20,temperature:1,top_p:10,details:!1,return_full_text:!1});return((0,r.useEffect)(()=>{!o&&s.length>0&&c(s[0])},[s]),(0,r.useEffect)(()=>{s.length>0&&c(s[0])},[e]),n)?(0,l.jsxs)("div",{className:"flex flex-col flex-shrink-0 justify-center h-[calc(100vh-64px)]",children:[(0,l.jsx)("div",{className:"flex flex-row justify-center items-center",children:(0,l.jsx)("img",{className:"h-16 w-auto mb-8",src:"img/dead-fish.png",alt:"blackfish-error"})}),(0,l.jsx)("div",{className:"flex flex-row justify-center items-center",children:"There's something fishy going on here."}),(0,l.jsx)("div",{className:"flex flex-row justify-center items-center",children:n.status})]}):i?(0,l.jsx)("div",{className:"flex flex-col flex-shrink-0 justify-center h-[calc(100vh-64px)]",children:(0,l.jsx)("div",{className:"flex flex-row justify-center items-center",children:(0,l.jsx)("img",{className:"animate-bounce h-16 w-auto mb-8",src:"/img/orca.png",alt:"blackfish-loading"})})}):(0,l.jsxs)("div",{className:"flex flex-row h-[calc(100vh-64px)]",children:[(0,l.jsx)(K,{selectedService:o,parameters:d}),(0,l.jsx)(z,{selectedService:o,setSelectedService:c,parameters:d,setParameters:u,profile:e,setProfile:t})]})}}},function(e){e.O(0,[501,248,620,336,971,117,744],function(){return e(e.s=6682)}),_N_E=e.O()}]);