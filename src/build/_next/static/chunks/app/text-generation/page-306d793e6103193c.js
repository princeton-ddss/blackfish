(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[782],{7984:function(e,t,s){Promise.resolve().then(s.bind(s,6407))},6407:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return K}});var r=s(7437),a=s(2265),l=s(8444),n=s(6117),i=s(3892),o=s(4079),c=s(3169),u=s(5839),d=s(9299),m=s(6584),x=s(5180),f=s(1469),h=s(3040),p=s(6935),g=s(1495),v=s(7986),b=s(9331),j=s(3600),w=s(3184),N=s(7551),y=s(3003);let k=(0,a.createContext)(null);k.displayName="GroupContext";let _=a.Fragment,S=Object.assign((0,j.yV)(function(e,t){var s;let r=(0,a.useId)(),l=(0,g.Q)(),_=(0,h.B)(),{id:S=l||"headlessui-switch-".concat(r),disabled:E=_||!1,checked:P,defaultChecked:T,onChange:C,name:I,value:F,form:D,autoFocus:L=!1,...O}=e,G=(0,a.useContext)(k),[R,z]=(0,a.useState)(null),M=(0,a.useRef)(null),Z=(0,f.T)(M,t,null===G?null:G.setSwitch,z),A=(0,u.L)(T),[B,H]=(0,c.q)(P,C,null!=A&&A),U=(0,d.G)(),[K,V]=(0,a.useState)(!1),W=(0,m.z)(()=>{V(!0),null==H||H(!B),U.nextFrame(()=>{V(!1)})}),X=(0,m.z)(e=>{if((0,v.P)(e.currentTarget))return e.preventDefault();e.preventDefault(),W()}),Y=(0,m.z)(e=>{e.key===N.R.Space?(e.preventDefault(),W()):e.key===N.R.Enter&&(0,b.g)(e.currentTarget)}),q=(0,m.z)(e=>e.preventDefault()),J=(0,y.wp)(),Q=(0,w.zH)(),{isFocusVisible:$,focusProps:ee}=(0,n.F)({autoFocus:L}),{isHovered:et,hoverProps:es}=(0,i.X)({isDisabled:E}),{pressed:er,pressProps:ea}=(0,o.x)({disabled:E}),el=(0,a.useMemo)(()=>({checked:B,disabled:E,hover:et,focus:$,active:er,autofocus:L,changing:K}),[B,et,$,er,E,K,L]),en=(0,j.dG)({id:S,ref:Z,role:"switch",type:(0,x.f)(e,R),tabIndex:-1===e.tabIndex?0:null!=(s=e.tabIndex)?s:0,"aria-checked":B,"aria-labelledby":J,"aria-describedby":Q,disabled:E||void 0,autoFocus:L,onClick:X,onKeyUp:Y,onKeyPress:q},ee,es,ea),ei=(0,a.useCallback)(()=>{if(void 0!==A)return null==H?void 0:H(A)},[H,A]);return a.createElement(a.Fragment,null,null!=I&&a.createElement(p.Mt,{disabled:E,data:{[I]:F||"on"},overrides:{type:"checkbox",checked:B},form:D,onReset:ei}),(0,j.sY)({ourProps:en,theirProps:O,slot:el,defaultTag:"button",name:"Switch"}))}),{Group:function(e){var t;let[s,r]=(0,a.useState)(null),[l,n]=(0,y.bE)(),[i,o]=(0,w.fw)(),c=(0,a.useMemo)(()=>({switch:s,setSwitch:r}),[s,r]);return a.createElement(o,{name:"Switch.Description",value:i},a.createElement(n,{name:"Switch.Label",value:l,props:{htmlFor:null==(t=c.switch)?void 0:t.id,onClick(e){s&&(e.currentTarget instanceof HTMLLabelElement&&e.preventDefault(),s.click(),s.focus({preventScroll:!0}))}}},a.createElement(k.Provider,{value:c},(0,j.sY)({ourProps:{},theirProps:e,slot:{},defaultTag:_,name:"Switch.Group"}))))},Label:y.__,Description:w.dk});function E(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter(Boolean).join(" ")}function P(e){let{name:t,value:s,onChange:a,min:l,max:n}=e;return(0,r.jsxs)("div",{className:"sm:col-span-4",children:[(0,r.jsxs)("div",{className:"flex flex-row justify-start",children:[(0,r.jsx)("label",{htmlFor:"username",className:"block grow text-sm font-medium leading-6 text-gray-900",children:t}),(0,r.jsx)("div",{className:"w-8 text-sm font-normal text-gray-900 leading-6",children:s})]}),(0,r.jsx)("div",{className:"mt-0",children:(0,r.jsx)("div",{className:"flex sm:max-w-md",children:(0,r.jsx)("input",{type:"range",name:t,id:t,min:l,max:n,value:s,onChange:a,className:"block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6"})})})]})}function T(e){let{checked:t,onChange:s,label:a,description:l}=e;return(0,r.jsxs)(S.Group,{as:"div",className:"flex items-center justify-between mt-3",children:[(0,r.jsxs)("span",{className:"flex flex-grow flex-col",children:[(0,r.jsx)(S.Label,{as:"span",className:"text-sm font-medium leading-6 text-gray-900",passive:!0,children:a}),(0,r.jsx)(S.Description,{as:"span",className:"text-sm font-light",children:l})]}),(0,r.jsx)(S,{checked:t,onChange:s,className:E(t?"bg-blue-500":"bg-gray-200","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"),children:(0,r.jsx)("span",{"aria-hidden":"true",className:E(t?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out")})})]})}function C(e){let{parameters:t,setParameters:s}=e;return(0,r.jsx)("div",{className:"bg-white sm:rounded-md mt-2 grow",children:(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsxs)("form",{children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-x-6 gap-y-2 sm:grid-cols-4",children:[(0,r.jsx)(P,{name:"Maximum New Tokens",value:t.max_new_tokens,min:1,max:4e3,onChange:e=>{s({...t,max_new_tokens:e.target.value})}}),(0,r.jsx)(P,{name:"Temperature",value:t.temperature,min:0,max:100,onChange:e=>{s({...t,temperature:e.target.value})}}),(0,r.jsx)(P,{name:"Top P",value:t.top_p,min:0,max:100,onChange:e=>{s({...t,top_p:e.target.value})}})]}),(0,r.jsx)(T,{checked:t.details,onChange:()=>{s({...t,details:!t.details})},label:"Details",description:"Return detailed model output"}),(0,r.jsx)(T,{checked:t.return_full_text,onChange:()=>{s({...t,return_full_text:!t.return_full_text})},label:"Full Text",description:"Return full text with response"})]})})})}function I(e){let{serviceIndex:t,setServiceIndex:s,mutateServices:a,models:n,parameters:i,setParameters:o}=e;return(0,r.jsxs)("div",{className:"flex flex-col w-96 p-8 pr-12 bg-white overflow-auto",children:[(0,r.jsx)(l.Z,{serviceIndex:t,setServiceIndex:s,mutateServices:a,models:n}),(0,r.jsx)(C,{parameters:i,setParameters:o})]})}function F(e){let{input:t,setInput:s,output:a,isLoading:l}=e;return(0,r.jsxs)("form",{action:"#",className:"flex flex-col h-full",children:[(0,r.jsx)("textarea",{name:"input",id:"input",className:"h-fit block w-full resize-none border-0 border-b border-transparent p-0 pb-2 text-gray-900 placeholder:text-gray-400 focus:border-0 focus:ring-0 sm:leading-6",placeholder:"Write me a haiku about orcas",value:t,onChange:e=>s(e.target.value)}),l?(0,r.jsx)("div",{className:"flex flex-row justify-center items-center",children:(0,r.jsx)("img",{className:"animate-bounce h-16 w-auto mt-20",src:"/img/orca.png",alt:"blackfish"})}):(0,r.jsx)("textarea",{name:"output",id:"output",className:"grow block w-full resize-none border-0 border-b border-transparent p-0 pb-2 text-fuchsia-500 placeholder:text-gray-400 focus:border-0 focus:ring-0 sm:leading-6",value:a,onChange:e=>null})]})}function D(e){let{input:t,setInput:s,output:a,setOutput:l,isLoading:n}=e;return(0,r.jsx)("div",{className:"grow w-5/6 sm:w-full max-w-6xl border border-gray-300 rounded-md mb-1",children:(0,r.jsx)("div",{className:"h-full px-4 sm:px-6 lg:px-8",children:(0,r.jsx)("div",{className:"h-full py-6 flow-root",children:(0,r.jsx)("div",{className:"h-full overflow-x-auto sm:-mx-6 lg:-mx-8",children:(0,r.jsx)("div",{className:"h-full inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8",children:(0,r.jsx)(F,{input:t,setInput:s,output:a,setOutput:l,isLoading:n})})})})})})}var L=s(7668);let O="http://127.0.0.1:8000";async function G(){let e=await fetch("".concat(O,"/models?refresh=true"));if(!e.ok){console.log("Failed to fetch models.");let t=Error("Failed to fetch models.");throw t.status=e.status,console.log(t),t}return e.json()}async function R(){console.log("fetching services");let e=await fetch("".concat(O,"/services"));if(!e.ok){console.log("Failed to fetch services.");let t=Error("Failed to fetch services.");throw t.status=e.status,console.log(t),t}return(await e.json()).filter(e=>"text_generation"===e.image)}async function z(e,t,s){let r=JSON.stringify({inputs:t,parameters:{...s,top_p:s.top_p/100,temperature:s.temperature/100}}),a=await fetch("".concat(O,"/fetch/text-generation/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:r});if(!a.ok)throw Error("Failed to call the service");return a.json()}var M=s(9728);let Z=()=>{let{data:e,error:t,isLoading:s}=(0,M.ZP)("models",G);return{models:e,error:t,isLoading:s}},A=()=>{let{data:e,error:t,isLoading:s,mutate:r}=(0,M.ZP)("services",R,{refreshInterval:5e3});return{services:e,error:t,isLoading:s,mutate:r}},B=["STOPPED","TIMEOUT","EXPIRED","FAILED","SUBMITTED","STARTING","PENDING"];function H(e){let{serviceIndex:t,input:s,setOutput:a,setIsLoading:l,parameters:n}=e,{services:i,isLoading:o}=A(),c=async e=>{e.preventDefault();let r=""===s?"Write me a haiku about orcas":s;console.log("text completion form submitted: ",r,n),l(!0);let o=await z(i[t].id,r,n);console.log(o),l(!1),a(o.generated_text)};return o?(0,r.jsx)("div",{}):(0,r.jsx)("div",{className:"flex flex-row w-1/2 max-w-2xl mb-8",children:(0,r.jsx)("div",{className:"grow w-full",children:(0,r.jsx)("form",{onSubmit:c,className:"mt-2 flex rounded-md",children:(0,r.jsxs)("button",{type:"submit",disabled:B.includes(i[t].state)||null===i[t].state,className:"relative disabled:text-gray-400 -ml-px inline-flex items-center gap-x-1.5 rounded-md px-3 py-2 text-sm font-medium text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:[(0,r.jsx)(L.Z,{className:"-ml-0.5 h-5 w-5","aria-hidden":"true"}),"Submit"]})})})})}function U(e){let{serviceIndex:t,parameters:s}=e,[l,n]=a.useState(""),[i,o]=a.useState(""),[c,u]=a.useState(!1);return(0,r.jsxs)("div",{className:"flex flex-col grow p-4 pt-6 pl-8 bg-white",children:[(0,r.jsx)(D,{input:l,setInput:n,output:i,setOutput:o,isLoading:c}),(0,r.jsx)(H,{input:l,serviceIndex:t,setOutput:o,setIsLoading:u,parameters:s})]})}function K(){let{models:e,error:t,isLoading:s}=Z(),{error:l,isLoading:n}=A(),[i,o]=a.useState(0),[c,u]=a.useState({max_new_tokens:200,temperature:1,top_p:10,details:!1,return_full_text:!1});return l||t?(0,r.jsxs)("div",{className:"flex flex-col flex-shrink-0 justify-center h-[calc(100vh-64px)]",children:[(0,r.jsx)("div",{className:"flex flex-row justify-center items-center",children:(0,r.jsx)("img",{className:"h-16 w-auto mb-8",src:"img/dead-fish.png",alt:"blackfish-error"})}),(0,r.jsx)("div",{className:"flex flex-row justify-center items-center",children:"There's something fishy going on here."}),l?(0,r.jsx)("div",{className:"flex flex-row justify-center items-center",children:l.status}):(0,r.jsx)("div",{className:"flex flex-row justify-center items-center",children:t.status})]}):n||s?(0,r.jsx)("div",{className:"flex flex-col flex-shrink-0 justify-center h-[calc(100vh-64px)]",children:(0,r.jsx)("div",{className:"flex flex-row justify-center items-center",children:(0,r.jsx)("img",{className:"animate-bounce h-16 w-auto mb-8",src:"/img/orca.png",alt:"blackfish-loading"})})}):(0,r.jsxs)("div",{className:"flex flex-row h-[calc(100vh-64px)]",children:[(0,r.jsx)(U,{serviceIndex:i,parameters:c}),(0,r.jsx)(I,{serviceIndex:i,setServiceIndex:o,models:e,parameters:c,setParameters:u})]})}}},function(e){e.O(0,[501,862,814,444,971,23,744],function(){return e(e.s=7984)}),_N_E=e.O()}]);