"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[444],{8444:function(e,s,t){t.d(s,{Z:function(){return W}});var r=t(7437),l=t(2265),a=t(8931),n=t(3003),i=t(5250),o=t(6057),c=t(9422),d=t(5554);function m(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter(Boolean).join(" ")}let u=["STOPPED","EXPIRED","TIMEOUT","FAILED"];function x(e){let{selected:s,setSelected:t}=e,{services:x,isLoading:h}=(0,d.Su)();return 0===x.length?(0,r.jsx)("div",{children:"No services found!"}):h?(0,r.jsx)("div",{}):(0,r.jsx)(a.Ri,{value:s,onChange:t,children:e=>{let{open:t}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.__,{className:"pt-2 block text-sm font-medium leading-6 text-gray-900",children:"Services"}),(0,r.jsxs)("div",{className:"relative mt-2",children:[(0,r.jsxs)(a.Y4,{className:"relative w-full cursor-default rounded-md bg-white py-1.5 pl-3 pr-10 text-left text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 sm:text-sm sm:leading-6",children:[(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)("span",{"aria-label":"HEALTHY"===x[s].status?"Online":"Offline",className:m(u.includes(x[s].status)?"bg-gray-200":"HEALTHY"===x[s].status?"bg-green-500":"UNHEALTHY"===x[s].status?"bg-red-500":"STARTING"===x[s].status?"animate-pulse bg-green-500":"bg-transparent border border-gray-300","inline-block h-2 w-2 flex-shrink-0 rounded-full")}),(0,r.jsx)("span",{className:"ml-3 block truncate",children:x[s].name})]}),(0,r.jsx)("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:(0,r.jsx)(o.Z,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})})]}),(0,r.jsx)(i.u,{show:t,as:l.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)(a.O_,{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",children:x.map((e,s)=>(0,r.jsx)(a.wt,{className:e=>{let{active:s}=e;return m(s?"bg-blue-500 text-white":"text-gray-900","relative cursor-default select-none py-2 pl-3 pr-9")},value:s,children:s=>{let{selected:t,active:l}=s;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:m(u.includes(e.status)?"bg-gray-200":"HEALTHY"===e.status?"bg-green-500":"UNHEALTHY"===e.status?"bg-red-400":"STARTING"===e.status?"animate-pulse bg-green-500":"bg-transparent border border-gray-300","inline-block h-2 w-2 flex-shrink-0 rounded-full"),"aria-hidden":"true"}),(0,r.jsxs)("span",{className:m(t?"font-semibold":"font-normal","ml-3 block truncate"),children:[e.name,(0,r.jsxs)("span",{className:"sr-only",children:[" ","is"," ","HEALTHY"===e.status?"online":"offline"]})]})]}),t?(0,r.jsx)("span",{className:m(l?"text-white":"text-blue-600","absolute inset-y-0 right-0 flex items-center pr-4"),children:(0,r.jsx)(c.Z,{className:"h-5 w-5","aria-hidden":"true"})}):null]})}},e.id))})})]})]})}})}var h=t(3934),f=t(1725),g=t(3009),b=t(786),p=t(9888),j=t(3489),v=t(6196),y=t(1111);let N=["STOPPED","TIMEOUT","EXPIRED","FAILED"],w=(e,s)=>{let t=Math.abs(s-e),r=t%1e3,l=(t=(t-r)/1e3)%60,a=(t=(t-l)/60)%60,n=(t=(t-a)/60)%24,i=(t-n)/24;return i>0?"".concat(i," days ").concat(a," min"):n>0?"".concat(n," hr ").concat(a," min"):a>0?"".concat(a," min ").concat(l," sec"):"".concat(l," sec")},k=e=>{let{refTime:s}=e,[t,a]=l.useState(new Date),n=()=>setTimeout(()=>{a(new Date),n()},3e4);return n(),(0,r.jsx)("div",{children:w(s,t)})};function T(e){let{service:s,setServiceIndex:t}=e,[a,n]=l.useState(!1),{services:i,mutate:o}=(0,d.Su)(),c=async()=>{console.log("stop button clicked: ",s.id),n(!0);try{await (0,y.Pp)(s.id),await o()}catch(e){console.log("Failed to stop the service.")}n(!1)},m=async()=>{console.log("delete button clicked: ",s.id),n(!0);try{await (0,y.wo)(s.id),t(0),await o()}catch(e){console.log("Failed to delete the service.")}n(!1)};return(0,r.jsx)("div",{className:" flex flex-row justify-start",children:(0,r.jsxs)("div",{className:"grow flex flex-col justify-center mt-2 mb-0",children:[(0,r.jsxs)("div",{className:"mt-2 ml-1 font-light text-sm sm:flex sm:flex-col",children:[(0,r.jsxs)("div",{className:"mb-1 ml-0 inline-flex justify-start items-center",children:[(0,r.jsx)(h.Z,{className:"h-6 w-6 text-gray-600 mr-1"}),(0,r.jsx)("div",{className:"grow font-medium text-sm mr-1",children:"Model "}),s.model]}),(0,r.jsxs)("div",{className:"mb-1 ml-0 inline-flex justify-start items-center capitalize",children:[(0,r.jsx)(f.Z,{className:"h-6 w-6 text-gray-600 mr-1"}),(0,r.jsx)("div",{className:"grow font-medium text-sm mr-1",children:"Status "}),a?(0,r.jsx)("div",{className:"bg-gray-300 rounded-md h-4 w-28 animate-pulse"}):(0,r.jsx)("div",{className:"STARTING"===s.status?"animate-pulse":"",children:null===s.status?"-":s.status.toLowerCase()})]}),(0,r.jsxs)("div",{className:"mb-1 ml-0 inline-flex items-center",children:[(0,r.jsx)(g.Z,{className:"h-6 w-6 text-gray-600 mr-1"}),(0,r.jsx)("div",{className:"grow font-medium text-sm mr-1",children:"Time "}),null===s.created_at||N.includes(s.status)?"-":(0,r.jsx)(k,{refTime:new Date(s.created_at),currentTime:new Date})]}),(0,r.jsxs)("div",{className:"mb-1 ml-0 inline-flex items-center",children:[(0,r.jsx)(b.Z,{className:"h-6 w-6 text-gray-600 mr-1"}),(0,r.jsx)("div",{className:"grow font-medium text-sm mr-1",children:"Host "}),N.includes(s.status)||null===s.host||null===s.port?"-":"".concat(s.host,":").concat(s.port)]}),(0,r.jsxs)("div",{className:"mb-1 ml-0 inline-flex items-center",children:[(0,r.jsx)(p.Z,{className:"h-6 w-6 text-gray-600 mr-1"}),(0,r.jsx)("div",{className:"grow font-medium text-sm mr-1",children:"Cores "}),s.ntasks_per_node||"-"]}),(0,r.jsxs)("div",{className:"mb-1 ml-0 inline-flex items-center",children:[(0,r.jsx)(j.Z,{className:"h-6 w-6 text-gray-600 mr-1"}),(0,r.jsx)("div",{className:"grow font-medium text-sm mr-1",children:"Memory "}),s.mem||"-"]}),(0,r.jsxs)("div",{className:"mb-1 ml-0 inline-flex items-center",children:[(0,r.jsx)(v.Z,{className:"h-6 w-6 text-gray-600 mr-1"}),(0,r.jsx)("div",{className:"grow font-medium text-sm mr-1",children:"GPU "}),s.gres?s.gres>0?"\uD83D\uDD25":"\uD83E\uDDCA":"-"]})]}),null===s.updated_at?(0,r.jsx)("div",{className:"grow text-center mt-2 font-light text-xs mb-2",children:(0,r.jsx)("div",{})}):(0,r.jsxs)("div",{className:"grow text-center mt-2 font-light text-xs mb-4",children:["Last updated",(0,r.jsx)(k,{refTime:new Date(s.updated_at),currentTime:new Date})]}),["STARTING","HEALTHY","UNHEALTHY"].includes(s.status)&&(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("button",{type:"button",className:"w-full flex flex-row justify-center gap-x-2 rounded-md bg-transparent px-3.5 py-1.5 text-sm font-regular shadow-sm hover:bg-slate-50 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 border",onClick:c,children:"Stop"})}),"PENDING"===s.status&&(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("button",{type:"button",className:"w-full flex flex-row justify-center gap-x-2 rounded-md bg-transparent px-3.5 py-1.5 text-sm font-regular shadow-sm hover:bg-slate-50 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 border",onClick:c,children:"Cancel"})}),N.includes(s.status)&&(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("button",{type:"button",className:"w-full flex flex-row justify-center gap-x-2 rounded-md bg-transparent px-3.5 py-1.5 text-sm font-regular shadow-sm hover:bg-slate-50 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 border",onClick:m,children:"Delete"})})]})})}var S=t(9328),C=t(6366),E=t(8364),F=t(9442);let _=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(s=>setTimeout(s,e))};var P=t(1367);function D(e){let{header:s,message:t}=e;return(0,r.jsx)("div",{className:"border-l-4 border-yellow-400 bg-yellow-50 p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(P.Z,{className:"h-5 w-5 text-yellow-400","aria-hidden":"true"})}),(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsxs)("p",{className:"text-sm text-yellow-700",children:[s+" ",(0,r.jsx)("div",{className:"font-light text-yellow-700 hover:text-yellow-600",children:t})]})})]})})}let V=[{id:0,name:"della.princeton.edu"}],L={time:"00:30:00",ntasks_per_node:8,mem:16,gres:1},O={revision:null,disableCustomKernels:!0,sharded:!1,maxInputLength:null,maxTotalTokens:null},R=e=>{if(""===e)return"";let[s,t,r]=e.split(":").map(e=>Number.parseInt(e));return 60*s+t},I=e=>"mig"===e.partition?1:"gpu80"===e.constraint?Math.max(Math.min(Math.floor(e.mem/80),2),1):Math.max(Math.min(Math.floor(e.mem/40),2),1);function Z(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter(Boolean).join(" ")}function A(e){let{options:s,disabled:t}=e,[n,o]=(0,l.useState)(s[0]);return(0,r.jsx)(a.Ri,{value:n,disabled:t,onChange:o,children:e=>{let{open:t}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"relative mt-2",children:[(0,r.jsxs)(a.Ri.Button,{className:"relative w-full cursor-default rounded-md bg-white py-1.5 pl-3 pr-10 text-left text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 sm:text-sm sm:leading-6 disabled:bg-gray-100",children:[(0,r.jsx)("span",{className:"block truncate",children:n.name}),(0,r.jsx)("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:(0,r.jsx)(C.Z,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})})]}),(0,r.jsx)(i.u,{show:t,as:l.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)(a.Ri.Options,{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",children:s.map(e=>(0,r.jsx)(a.Ri.Option,{className:e=>{let{active:s}=e;return Z(s?"bg-blue-500 text-white":"text-gray-900","relative cursor-default select-none py-2 pl-3 pr-9")},value:e,children:s=>{let{selected:t,active:l}=s;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:Z(t?"font-semibold":"font-normal","block truncate"),children:e.name}),t?(0,r.jsx)("span",{className:Z(l?"text-white":"text-blue-500","absolute inset-y-0 right-0 flex items-center pr-4"),children:(0,r.jsx)(E.Z,{className:"h-5 w-5","aria-hidden":"true"})}):null]})}},e.id))})})]})})}})}function H(e){let{label:s,value:t,setValue:a,validator:n,type:i,disabled:o}=e,c=n(String(t)),[d,m]=l.useState(c.isValid),[u,x]=l.useState(c.error||"");return(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium leading-6 text-gray-900",children:s}),(0,r.jsxs)("div",{className:"relative mt-2 rounded-md shadow-sm",children:[(0,r.jsx)("input",{type:i,disabled:o,className:Z(d?"":"text-red-900 ring-red-300 placeholder:text-red-300 focus:ring-red-500","block w-full rounded-md border-0 py-1.5 pr-10 ring-inset focus:ring-2 focus:ring-inset sm:text-sm sm:leading-6 disabled:bg-gray-100 disabled:ring-1 disabled:ring-gray-300"),value:t,onChange:e=>{a(e.target.value);let s=n(e.target.value);s.isValid?(m(!0),x(null)):(m(!1),x(s.error))},"aria-invalid":"true","aria-describedby":"email-error"}),!d&&(0,r.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3",children:(0,r.jsx)(F.Z,{className:"h-5 w-5 text-red-500","aria-hidden":"true"})})]}),!d&&(0,r.jsx)("p",{className:"mt-2 text-sm text-red-600",id:"email-error",children:u})]})}function M(e){return e?{isValid:!0}:{error:"Name must not be empty",isValid:!1}}function U(e){return Number.isInteger(Number(e.trim()))&&""!==e?1>Number(e.trim())?{error:"Time should be greater than or equal to 1.",isValid:!1}:Number(e.trim())>128?{error:"Time should be less than 180.",isValid:!1}:{isValid:!0}:{error:"Time should be a valid positive integer.",isValid:!1}}function G(e){return Number.isInteger(Number(e.trim()))&&""!==e?8>Number(e.trim())?{error:"CPU cores should be greater than or equal to 8.",isValid:!1}:Number(e.trim())>128?{error:"CPU cores should be less than 128.",isValid:!1}:{isValid:!0}:{error:"CPU cores should be a valid integer.",isValid:!1}}function B(e){return Number.isInteger(Number(e.trim()))&&""!==e?8>Number(e.trim())?{error:"Memory should be a greater than or equal to 8 GB.",isValid:!1}:Number(e.trim())>256?{error:"Memory should be less than 128.",isValid:!1}:{isValid:!0}:{error:"Memory should be a valid integer.",isValid:!1}}function z(e){let{model:s,name:t,setName:a,services:n,jobOptions:i,setJobOptions:o,containerOptions:c,setContainerOptions:d,disabled:m}=e,[u,x]=l.useState("della"),[h,f]=l.useState("default");return(0,r.jsxs)("div",{className:"max-w-2xl space-y-6 md:col-span-2",children:[(0,r.jsxs)("fieldset",{children:[(0,r.jsx)("legend",{className:"text-sm font-semibold leading-6 text-gray-900",children:"Name"}),(0,r.jsx)("p",{className:"mt-1 text-sm leading-6 text-gray-600",children:"Give your service a name (or use our wonderful suggestion)."}),(0,r.jsx)("div",{className:"relative mt-2 rounded-md shadow-sm",children:(0,r.jsx)(H,{type:"text",name:"name",id:"name",disabled:m,value:m?n[n.length-1].name:t,setValue:e=>{a(e)},validator:M})})]}),(0,r.jsxs)("fieldset",{children:[(0,r.jsx)("legend",{className:"text-sm font-semibold leading-6 text-gray-900",children:"Cluster"}),(0,r.jsx)("p",{className:"mt-1 text-sm leading-6 text-gray-600",children:"Where would you like to run this model?"}),(0,r.jsx)("div",{className:"mt-4 space-y-6",children:(0,r.jsx)(A,{options:V,disabled:m,handleSelect:e=>{x(e.target.value)}})})]}),(0,r.jsxs)("fieldset",{children:[(0,r.jsx)("legend",{className:"text-sm font-semibold leading-6 text-gray-900",children:"Time"}),(0,r.jsx)("p",{className:"mt-1 text-sm leading-6 text-gray-600",children:"How long would you like to run this model?"}),(0,r.jsx)("div",{className:"mt-3 space-y-3",children:(0,r.jsx)(H,{type:"number",disabled:m,value:R(i.time),setValue:e=>{o({...i,time:""===e?e:"00:".concat(String(e).padStart(2,"0"),":00")})},validator:U})})]}),(0,r.jsxs)("fieldset",{children:[(0,r.jsx)("legend",{className:"text-sm font-semibold leading-6 text-gray-900",children:"Resources"}),(0,r.jsx)("p",{className:"mt-1 text-sm leading-6 text-gray-600",children:"Request resources for the model."}),(0,r.jsx)("div",{className:"mt-2 text-sm font-medium inline-flex",children:(0,r.jsx)(D,{header:"Warning",message:"Changing the settings below may cause your service to fail or over utilize resources."})}),(0,r.jsxs)("div",{className:"mt-6 space-y-3",children:[(0,r.jsx)(H,{type:"number",disabled:m,label:"CPU Cores",value:i.ntasks_per_node,setValue:e=>{o({...i,ntasks_per_node:e})},validator:G}),(0,r.jsx)(H,{type:"number",disabled:m,label:"CPU Memory (GB)",value:i.mem,setValue:e=>{o({...i,mem:e})},validator:B}),(0,r.jsxs)("div",{className:"relative flex gap-x-3",children:[(0,r.jsx)("div",{className:"flex h-6 items-center",children:(0,r.jsx)("input",{id:"offers",name:"offers",type:"checkbox",disabled:m,checked:i.gres>0,onChange:()=>{i.gres>0?o({...i,gres:0}):o({...i,gres:I(i)})},className:"h-4 w-4 rounded border-gray-300 text-blue-500 focus:ring-blue-500 disabled:bg-gray-100"})}),(0,r.jsxs)("div",{className:"text-sm leading-6",children:[(0,r.jsx)("label",{htmlFor:"offers",className:"font-medium text-gray-900",children:"Use GPU"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Select if the model requires access to a GPU."})]})]})]})]})]})}function Y(e){let{model:s,open:t,setOpen:a}=e,{services:n,isLoading:o,error:c,mutate:m}=(0,d.Su)(),[u,x]=l.useState("".concat(n.length+1,"-").concat(s.repo.split("/")[1])),[h,f]=l.useState({...L}),[g,b]=l.useState({...O}),[p,j]=l.useState(!1),[v,N]=l.useState(!1);l.useEffect(()=>{p||v||(f(L),b({...O}))},[s,n,p,v]);let w=(0,l.useRef)(null),k=async()=>{console.log("launch button clicked"),f({...h,user:profile.user,home_dir:profile.home_dir,cache_dir:profile.cache_dir,model_dir:model_dir}),N(!0);let e=await (0,y.ui)({name:u,image:"text_generation",model:s,job_type:profile.type,host:profile.host,user:profile.user,container_options:g,job_options:h});console.log("response: ",e);for(let s=0;s<3;s+=1){await _(1e4);try{let s=await (0,y.uv)(e.task);console.log("New service found on remote: ",s.name),await m(),N(!1),j(!0);break}catch(e){console.log("New  service not found on remote. Re-trying in 3 seconds (attempt: ".concat(s,")."))}}N(!1)};return c?(0,r.jsx)("div",{children:"Error"}):o?(0,r.jsx)("div",{}):(0,r.jsx)(i.u.Root,{show:t,as:l.Fragment,children:(0,r.jsxs)(S.Vq,{as:"div",className:"relative z-10",initialFocus:w,onClose:()=>{a(!1),j(!1),N(!1)},children:[(0,r.jsx)(i.u.Child,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"})}),(0,r.jsx)("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto",children:(0,r.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,r.jsx)(i.u.Child,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,r.jsxs)(S.Vq.Panel,{className:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-4xl sm:p-6 sm:pl-6",children:[(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"mt-3 sm:mt-5",children:[(0,r.jsx)(S.Vq.Title,{as:"h3",className:"text-base font-semibold leading-6 text-gray-900"}),(0,r.jsx)("form",{className:"mt-0",children:(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-x-12 gap-y-10 border-b border-gray-900/10 pb-12 md:grid-cols-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-base font-semibold leading-7 text-gray-900",children:"Summary"}),v?(0,r.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,r.jsxs)("span",{className:"relative flex h-5 w-5",children:[(0,r.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"}),(0,r.jsx)("span",{className:"relative inline-flex rounded-full h-5 w-5 bg-blue-500"})]})}):(0,r.jsx)(T,{service:p?n[n.length-1]:{model:s.name,name:null,status:null,created:null,updated:null,host:null,ntasks_per_node:h.ntasks_per_node,mem:h.mem,gres:h.gres}})]}),(0,r.jsx)(z,{model:s,name:u,setName:x,services:n,jobOptions:h,setJobOptions:f,containerOptions:g,setContainerOptions:b,disabled:p||v})]})})})]})}),p?(0,r.jsx)("div",{className:"mt-5 sm:mt-6 sm:grid sm:grid-flow-row-dense sm:grid-cols-2 sm:gap-3",children:(0,r.jsx)("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:col-start-1 sm:col-span-2 sm:mt-0",onClick:()=>{a(!1),j(!1)},ref:w,children:"Back"})}):(0,r.jsxs)("div",{className:"mt-5 sm:mt-6 sm:grid sm:grid-flow-row-dense sm:grid-cols-2 sm:gap-3",children:[(0,r.jsx)("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-blue-500 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-500 sm:col-start-2",onClick:k,children:"Launch"}),(0,r.jsx)("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:col-start-1 sm:mt-0",onClick:()=>a(!1),ref:w,children:"Cancel"})]})]})})})})]})})}function q(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter(Boolean).join(" ")}function J(e){let{models:s,selected:t,setSelected:n}=e;return(0,r.jsx)(a.Ri,{value:t,onChange:n,children:e=>{let{open:n}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.Ri.Label,{className:"border-t pt-6 block text-sm font-medium leading-6 text-gray-900",children:"Models"}),(0,r.jsxs)("div",{className:"relative mt-2",children:[(0,r.jsxs)(a.Ri.Button,{className:"relative w-full cursor-default rounded-md bg-white py-1.5 pl-1 pr-10 text-left text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 sm:text-sm sm:leading-6",children:[(0,r.jsx)("span",{className:"flex items-center",children:(0,r.jsx)("span",{className:"ml-3 block truncate",children:s[t].repo})}),(0,r.jsx)("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:(0,r.jsx)(o.Z,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})})]}),(0,r.jsx)(i.u,{show:n,as:l.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)(a.Ri.Options,{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",children:s.map((e,s)=>(0,r.jsx)(a.Ri.Option,{className:e=>{let{active:s}=e;return q(s?"bg-blue-500 text-white":"text-gray-900","relative cursor-default select-none py-2 pl-1 pr-9")},value:s,children:s=>{let{selected:t,active:l}=s;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{"aria-hidden":"true"}),(0,r.jsx)("span",{className:q(t?"font-semibold":"font-normal","ml-3 block truncate"),children:e.repo})]}),t?(0,r.jsx)("span",{className:q(l?"text-white":"text-blue-600","absolute inset-y-0 right-0 flex items-center pr-4"),children:(0,r.jsx)(c.Z,{className:"h-5 w-5","aria-hidden":"true"})}):null]})}},e.repo+e.revision+e.profile))})})]})]})}})}function Q(e){let{model:s,setModalOpen:t}=e;return(0,r.jsx)("div",{className:" flex flex-row justify-start border-b",children:(0,r.jsxs)("div",{className:"grow flex flex-col justify-center mt-2 mb-6",children:[(0,r.jsxs)("div",{className:"mt-2 ml-1 font-light text-sm sm:flex sm:flex-col",children:[(0,r.jsxs)("div",{className:"mb-1 ml-0 flex flex-col justify-start items-left",children:[(0,r.jsx)("div",{className:"inline-flex items-center mb-2",children:(0,r.jsx)("div",{className:"grow font-medium text-sm mr-1",children:"Description "})}),null==s?void 0:s.description]}),(0,r.jsxs)("div",{className:"mt-2 mb-1 ml-0 flex flex-col justify-start items-left",children:[(0,r.jsx)("div",{className:"inline-flex items-center mb-2",children:(0,r.jsx)("div",{className:"grow font-medium text-sm mr-1",children:"Link "})}),(0,r.jsx)("a",{href:null==s?void 0:s.link,children:null==s?void 0:s.link})]})]}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{type:"button",className:"mt-2 w-full flex flex-row justify-center gap-x-2 rounded-md bg-tranparent px-3.5 py-1.5 text-sm font-regular shadow-sm hover:bg-slate-50 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 border",onClick:()=>{t(!0)},children:"Create"})})]})})}function W(e){let{serviceIndex:s,setServiceIndex:t,models:a}=e,{services:n,error:i,isLoading:o}=(0,d.Su)(),[c,m]=l.useState(!1),[u,h]=l.useState(0);return i?(0,r.jsx)("div",{children:"Error"}):o?(0,r.jsx)("div",{children:"Loading..."}):(0,r.jsxs)("div",{children:[(0,r.jsx)(x,{selected:s,setSelected:t}),(0,r.jsx)(T,{service:n[s],setServiceIndex:t}),(0,r.jsx)(J,{models:a,selected:u,setSelected:h}),(0,r.jsx)(Q,{model:a[u],setModalOpen:m}),(0,r.jsx)(Y,{model:a[u],open:c,setOpen:m,serviceIndex:s,setServiceIndex:t})]})}t(7138)},5554:function(e,s,t){t.d(s,{Su:function(){return n},bP:function(){return a},of:function(){return i}});var r=t(9728),l=t(1111);let a=()=>{let{data:e,error:s,isLoading:t}=(0,r.ZP)("models",l.fm);return{models:e,error:s,isLoading:t}},n=()=>{let{data:e,error:s,isLoading:t,mutate:a}=(0,r.ZP)("services",l.Qz,{refreshInterval:5e3});return{services:e,error:s,isLoading:t,mutate:a}},i=e=>{let{data:s,error:t,isLoading:a,mutate:n}=(0,r.ZP)("files?path=".concat(e),l.uB,{});return{files:s,error:t,isLoading:a,refresh:n}}},1111:function(e,s,t){t.d(s,{Pp:function(){return c},Qz:function(){return n},fm:function(){return a},uB:function(){return l},ui:function(){return i},uv:function(){return o},wo:function(){return d}});let r="http://127.0.0.1:8000";async function l(e){console.debug("from fetchFiles: path=".concat(r,"/").concat(e));let s=await fetch("".concat(r,"/").concat(e));if(!s.ok){let e=Error("Failed to fetch files.");throw e.status=s.status,console.error(e),e}return s.json()}async function a(){let e=await fetch("".concat(r,"/models?refresh=true"));if(!e.ok){let s=Error("Failed to fetch models.");throw s.status=e.status,console.error(s),s}return e.json()}async function n(){console.debug("from fetchServices: path=".concat(r,"/services"));let e=await fetch("".concat(r,"/services"));if(!e.ok){let s=Error("Failed to fetch services.");throw s.status=e.status,console.error(s),s}return await e.json()}async function i(e){let s=JSON.stringify(e),t=await fetch("".concat(r,"/services"),{method:"POST",headers:{"Content-Type":"application/json"},body:s});if(!t.ok)throw Error("Failed to start the service");return t.json()}async function o(e){let s=await fetch("".concat(r,"/services/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"},mode:"cors"});if(!s.ok)throw Error("Failed to get service details.");return s.json()}async function c(e){let s=JSON.stringify({delay:0}),t=await fetch("".concat(r,"/services/").concat(e,"/stop"),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",body:s});if(!t.ok)throw Error("Failed to stop the service");return t.json()}async function d(e){let s=JSON.stringify({force:!1}),t=await fetch("".concat(r,"/services/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json"},mode:"cors",body:s});if(!t.ok)throw Error("Failed to delete the service");return t.json()}}}]);