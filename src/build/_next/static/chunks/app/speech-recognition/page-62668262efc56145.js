(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[675],{728:function(e,t,s){Promise.resolve().then(s.bind(s,7575))},7575:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return L}});var a=s(7437),l=s(2265),n=s(8444),r=s(8931),i=s(3003),c=s(6057),o=s(9422);let d=[{id:1,name:"English"},{id:2,name:"French"},{id:3,name:"Spanish"},{id:4,name:"German"},{id:5,name:"Chinese"},{id:6,name:"Norwegian"},{id:7,name:"Swedish"},{id:8,name:"Dutch"}];function m(e){let{language:t,setLanguage:s}=e;return(0,a.jsxs)(r.Ri,{value:t,onChange:s,children:[(0,a.jsx)(i.__,{className:"block text-sm font-medium leading-6 text-gray-900",children:"Language"}),(0,a.jsxs)("div",{className:"relative mt-2",children:[(0,a.jsxs)(r.Y4,{className:"relative w-full cursor-default rounded-md bg-white py-1.5 pl-3 pr-10 text-left text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 sm:text-sm sm:leading-6",children:[(0,a.jsx)("span",{className:"block truncate",children:t.name}),(0,a.jsx)("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:(0,a.jsx)(c.Z,{"aria-hidden":"true",className:"h-5 w-5 text-gray-400"})})]}),(0,a.jsx)(r.O_,{transition:!0,className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none data-[closed]:data-[leave]:opacity-0 data-[leave]:transition data-[leave]:duration-100 data-[leave]:ease-in sm:text-sm",children:d.map(e=>(0,a.jsxs)(r.wt,{value:e,className:"group relative cursor-default select-none py-2 pl-3 pr-9 text-gray-900 data-[focus]:bg-blue-500 data-[focus]:text-white",children:[(0,a.jsx)("span",{className:"block truncate font-normal group-data-[selected]:font-semibold",children:e.name}),(0,a.jsx)("span",{className:"absolute inset-y-0 right-0 flex items-center pr-4 text-blue-500 group-data-[focus]:text-white [.group:not([data-selected])_&]:hidden",children:(0,a.jsx)(o.Z,{"aria-hidden":"true",className:"h-5 w-5"})})]},e.id))})]})]})}function x(e){let{parameters:t,setParameters:s}=e;return(0,a.jsx)(m,{language:t.language,setLanguage:e=>{console.log("setLanguage: ".concat(t.language.name," -> ").concat(e.name)),s({...t,language:e})}})}function u(e){let{serviceIndex:t,setServiceIndex:s,mutateServices:l,models:r,parameters:i,setParameters:c}=e;return(0,a.jsxs)("div",{className:"flex flex-col w-96 p-8 pr-12 bg-white overflow-auto",children:[(0,a.jsx)(n.Z,{serviceIndex:t,setServiceIndex:s,mutateServices:l,models:r}),(0,a.jsx)(x,{parameters:i,setParameters:c})]})}var h=s(4167),g=s(1604),p=s(4728),f=s(6730),j=s(4064),w=s(9808),v=s(5554);function y(e){let{path:t,query:s,setQuery:l}=e;return(0,a.jsx)("div",{id:"search-bar",children:(0,a.jsxs)("div",{className:"relative mt-2 rounded-md ",children:[(0,a.jsx)("input",{id:"path-query",name:"path-query",type:"text",placeholder:t,value:t+"/"+s,onChange:e=>{e.target.value===t?(console.debug("setQuery:"),l("")):e.target.value.match(t+"/")&&(console.debug("setQuery: ".concat(e.target.value.replace(t+"/",""))),l(e.target.value.replace(t+"/","")))},className:"block w-full rounded-md border-0 py-1.5 pr-10 text-gray-900 ring-0 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-blue-500 sm:text-sm sm:leading-6"}),(0,a.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3",children:(0,a.jsx)(h.Z,{"aria-hidden":"true",className:"h-5 w-5 text-gray-400"})})]})})}function b(e){let{content:t,path:s,setAudioPath:n,setPath:r,selected:i,setSelected:c,refresh:o}=e,[d,m]=(0,l.useState)(""),x=""===d?t:t.filter(e=>e.name.toLowerCase().includes(d.toLowerCase()));return(0,a.jsxs)("div",{id:"content-table",className:"flex-none",children:[(0,a.jsx)("div",{className:"sm:flex sm:items-center",children:(0,a.jsx)("div",{className:"sm:flex-auto",children:(0,a.jsx)(y,{path:s,query:d,setQuery:m})})}),(0,a.jsx)("div",{className:"mt-2 flow-root",children:(0,a.jsx)("div",{className:"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8",children:(0,a.jsx)("div",{className:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg h-96 overflow-y-scroll",children:(0,a.jsxs)("table",{className:"divide-y divide-gray-300 table-fixed w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",className:"relative whitespace-nowrap py-4 text-left text-sm font-medium sm:pr-4 w-24",children:(0,a.jsx)("button",{onClick:()=>{let e=s.split("/"),t=e.slice(0,e.length-1).join("/");console.debug("setPath: ".concat(t)),r(t)},children:(0,a.jsx)(g.Z,{className:"h-5 w-5 mt-1 ml-4 text-black"})})}),(0,a.jsx)("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6 w-1/2",children:"Name"}),(0,a.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 w-24",children:"Size"}),(0,a.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 w-48",children:"Last Modified"}),(0,a.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 w-12",children:(0,a.jsx)("button",{onClick:()=>{o()},children:(0,a.jsx)(p.Z,{className:"h-5 w-5 mt-1 text-black"})})})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:x.map(e=>(0,a.jsxs)("tr",{className:i===e.path?"bg-gray-100":"bg-white",children:[(0,a.jsx)("td",{className:"relative whitespace-nowrap w-10 py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6",children:(0,a.jsx)("a",{href:"#",className:"text-gray-500 hover:text-gray-800",children:e.is_dir?(0,a.jsx)(f.Z,{className:"h-7 w-7"}):(0,a.jsx)(j.Z,{className:"h-7 w-7"})})}),(0,a.jsx)("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6",children:(0,a.jsx)("div",{className:"overflow-x-scroll",children:e.name})}),(0,a.jsx)("td",{className:"whitespace-nowrap w-36 px-3 py-4 text-sm text-gray-500",children:e.is_dir?"-":function(e){let t=parseInt(e);return t/1e3<1?"".concat(t," B"):t/1e6<1?"".concat(Math.floor(t/1e3)," KB"):t/1e9<1?"".concat(Math.floor(t/1e6)," MB"):t/1e12<1?"".concat(Math.floor(t/1e9)," GB"):"".concat(Math.floor(t/1e12)," TB")}(e.size)}),(0,a.jsx)("td",{className:"whitespace-nowrap w-48 px-3 py-4 text-sm text-gray-500",children:(0,a.jsx)("div",{className:"flex",children:(e.modified_at,"5 seconds ago")})}),(0,a.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:(0,a.jsx)("div",{className:"flex",children:e.is_dir?(0,a.jsx)("button",{onClick:()=>{console.debug("setPath: ".concat(e.path)),r(e.path)},className:"text-gray-500 hover:text-gray-800",children:(0,a.jsx)(w.Z,{className:"h-5 w-5 mt-1"})}):(0,a.jsx)("input",{type:"checkbox",checked:i===e.path,onChange:async()=>{i===e.path?(console.debug("setSelected: ".concat(null)),c(null),n(null)):(console.debug("setSelected: ".concat(e.path)),c(e.path),n(e.path))},className:"h-4 w-4 rounded border-gray-300 text-blue-500 focus:ring-blue-600"})})})]},e.path))})]})})})})})]})}function N(e){let{setAudioPath:t}=e,[s,n]=(0,l.useState)("/tmp"),[r,i]=(0,l.useState)(""),{files:c,error:o,isLoading:d,refresh:m}=(0,v.of)(s);return o?(0,a.jsx)("div",{children:"Error"}):d?(0,a.jsx)("div",{children:"Loading..."}):(0,a.jsx)("div",{id:"remote-file-browser",className:"mb-2 w-5/6 sm:w-full max-w-6xl",children:(0,a.jsx)(b,{content:c,path:s,setAudioPath:t,setPath:n,selected:r,setSelected:i,refresh:m})})}function S(e){let{audioPath:t}=e;return t?(0,a.jsx)("audio",{src:"".concat("http://127.0.0.1:8000","/audio?path=").concat(t),className:"w-5/6 max-w-5/6 sm:w-full sm:max-w-6xl my-3",controls:!0}):(0,a.jsx)("audio",{className:"w-5/6 max-w-5/6 sm:w-full sm:max-w-6xl my-3",controls:!0})}function k(e){let{output:t,isLoading:s}=e;return(0,a.jsx)("div",{className:"grow w-5/6 sm:w-full max-w-6xl shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg mb-1 mt-1 overflow-y-scroll",children:(0,a.jsx)("div",{className:"h-full px-4 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"h-full py-6 flow-root",children:(0,a.jsx)("div",{className:"h-full overflow-x-auto sm:-mx-6 lg:-mx-8",children:(0,a.jsx)("div",{className:"h-full inline-block min-w-full py-2 align-middle",children:(0,a.jsx)("div",{children:s?(0,a.jsx)("div",{className:"flex flex-row justify-center items-center",children:(0,a.jsx)("img",{className:"animate-bounce h-16 w-auto mt-20",src:"/img/orca.png",alt:"blackfish"})}):(0,a.jsx)("textarea",{name:"transcription-output",id:"transcription-output",className:"h-36 block w-full resize-none border-0 border-b border-transparent p-0 pb-2 text-gray-600 placeholder:text-gray-400 focus:border-0 focus:ring-0 sm:leading-6 px-6",value:t,placeholder:"Select a file to transcribe.",onChange:e=>null})})})})})})})}s(9370);var P=s(7668);async function _(e,t,s){let a=e.mounts.split(",")[0],l={audio_path:t.replace(a,"/data/audio"),response_format:"text",language:s.language.name.toLowerCase()},n=await fetch("http://".concat(e.host,":").concat(e.port,"/transcribe"),{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify(l)});if(!n.ok)throw Error("Failed to call the service");return n.json()}let C=["STOPPED","TIMEOUT","EXPIRED","FAILED","SUBMITTED","STARTING","PENDING"];function E(e){let{audioPath:t,setOutput:s,serviceIndex:l,parameters:n,setIsLoading:r}=e,{services:i,isLoading:c}=(0,v.Su)(),o=async e=>{e.preventDefault(),console.debug("from handleSubmit: service=".concat(i[l].id)),r(!0);let a=await _(i[l],t,n);r(!1),s(a.text.trim())};return c?(0,a.jsx)("div",{}):(0,a.jsx)("div",{className:"flex flex-row w-1/2 max-w-2xl mb-8",children:(0,a.jsx)("div",{className:"grow w-full",children:(0,a.jsx)("form",{onSubmit:o,className:"mt-2 flex rounded-md",children:(0,a.jsxs)("button",{type:"submit",disabled:0===i.length||C.includes(i[l].status)||null===i[l].status||null===t,className:"relative disabled:text-gray-400 -ml-px inline-flex items-center gap-x-1.5 rounded-md px-3 py-2 text-sm font-medium text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:[(0,a.jsx)(P.Z,{className:"-ml-0.5 h-5 w-5","aria-hidden":"true"}),"Submit"]})})})})}function I(e){let{serviceIndex:t,parameters:s}=e,[n,r]=(0,l.useState)(null),[i,c]=(0,l.useState)(""),[o,d]=(0,l.useState)(!1);return(0,a.jsx)("div",{className:"flex flex-col grow p-4 pt-6 pl-8 bg-white",children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)(N,{setAudioPath:r}),(0,a.jsx)(S,{audioPath:n}),(0,a.jsx)(k,{output:i,isLoading:o}),(0,a.jsx)(E,{audioPath:n,setOutput:c,serviceIndex:t,parameters:s,setIsLoading:d})]})})}function L(){let{models:e,error:t,isLoading:s}=(0,v.bP)(),{error:n,isLoading:r}=(0,v.Su)(),[i,c]=l.useState(0),[o,d]=l.useState({language:{id:0,name:"English"}});return n||t?(0,a.jsxs)("div",{className:"flex flex-col flex-shrink-0 justify-center h-[calc(100vh-64px)]",children:[(0,a.jsx)("div",{className:"flex flex-row justify-center items-center",children:(0,a.jsx)("img",{className:"h-16 w-auto mb-8",src:"img/dead-fish.png",alt:"blackfish-error"})}),(0,a.jsx)("div",{className:"flex flex-row justify-center items-center",children:"There's something fishy going on here."}),n?(0,a.jsx)("div",{className:"flex flex-row justify-center items-center",children:n.status}):(0,a.jsx)("div",{className:"flex flex-row justify-center items-center",children:t.status})]}):r||s?(0,a.jsx)("div",{className:"flex flex-col flex-shrink-0 justify-center h-[calc(100vh-64px)]",children:(0,a.jsx)("div",{className:"flex flex-row justify-center items-center",children:(0,a.jsx)("img",{className:"animate-bounce h-16 w-auto mb-8",src:"/img/orca.png",alt:"blackfish-loading"})})}):(0,a.jsxs)("div",{className:"flex flex-row h-[calc(100vh-64px)]",children:[(0,a.jsx)(I,{serviceIndex:i,parameters:o}),(0,a.jsx)(u,{serviceIndex:i,setServiceIndex:c,models:e,parameters:o,setParameters:d})]})}}},function(e){e.O(0,[501,862,814,534,444,971,23,744],function(){return e(e.s=728)}),_N_E=e.O()}]);